Starting comparative evaluation of gradient routing models
Time: Thu 19 Feb 2026 08:03:41 UTC
Thu Feb 19 08:03:41 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 565.57.01              Driver Version: 565.57.01      CUDA Version: 12.7     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GH200 120GB             On  |   00000009:01:00.0 Off |                    0 |
| N/A   34C    P0             87W /  900W |       2MiB /  97871MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA GH200 120GB             On  |   00000019:01:00.0 Off |                    0 |
| N/A   35C    P0             87W /  900W |       1MiB /  97871MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA GH200 120GB             On  |   00000029:01:00.0 Off |                    0 |
| N/A   35C    P0             52W /  900W |       1MiB /  97871MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA GH200 120GB             On  |   00000039:01:00.0 Off |                    0 |
| N/A   35C    P0             87W /  900W |       1MiB /  97871MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
`torch_dtype` is deprecated! Use `dtype` instead!
Running comparative evaluation on device=device(type='cuda', index=1)

======================================================================
EVALUATING: Pretrained baseline (no unlearning)
======================================================================
Loaded pretrained model roneneldan/TinyStories-28M into HookedTransformer
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 1/200 [00:00<01:21,  2.43it/s]  2%|▎         | 5/200 [00:00<00:16, 11.96it/s]  6%|▌         | 12/200 [00:00<00:06, 27.19it/s] 10%|▉         | 19/200 [00:00<00:04, 38.91it/s] 14%|█▎        | 27/200 [00:00<00:03, 48.85it/s] 18%|█▊        | 35/200 [00:00<00:02, 55.52it/s] 22%|██▏       | 43/200 [00:01<00:02, 60.06it/s] 26%|██▌       | 51/200 [00:01<00:02, 63.29it/s] 30%|██▉       | 59/200 [00:01<00:02, 65.70it/s] 34%|███▎      | 67/200 [00:01<00:01, 68.03it/s] 38%|███▊      | 75/200 [00:01<00:01, 69.44it/s] 42%|████▏     | 83/200 [00:01<00:01, 70.24it/s] 46%|████▌     | 91/200 [00:01<00:01, 70.47it/s] 50%|████▉     | 99/200 [00:01<00:01, 70.78it/s] 54%|█████▎    | 107/200 [00:01<00:01, 70.94it/s] 57%|█████▊    | 115/200 [00:02<00:01, 70.89it/s] 62%|██████▏   | 123/200 [00:02<00:01, 70.78it/s] 66%|██████▌   | 131/200 [00:02<00:00, 70.97it/s] 70%|██████▉   | 139/200 [00:02<00:00, 71.22it/s] 74%|███████▎  | 147/200 [00:02<00:00, 71.56it/s] 78%|███████▊  | 155/200 [00:02<00:00, 71.70it/s] 82%|████████▏ | 163/200 [00:02<00:00, 71.58it/s] 86%|████████▌ | 171/200 [00:02<00:00, 71.36it/s] 90%|████████▉ | 179/200 [00:02<00:00, 71.63it/s] 94%|█████████▎| 187/200 [00:03<00:00, 71.33it/s] 96%|█████████▋| 193/200 [00:03<00:00, 60.91it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▍         | 8/200 [00:00<00:02, 71.07it/s]  8%|▊         | 16/200 [00:00<00:02, 71.52it/s] 12%|█▏        | 24/200 [00:00<00:02, 71.66it/s] 16%|█▌        | 32/200 [00:00<00:02, 72.36it/s] 20%|██        | 40/200 [00:00<00:02, 72.61it/s] 24%|██▍       | 48/200 [00:00<00:02, 72.76it/s] 28%|██▊       | 56/200 [00:00<00:01, 72.49it/s] 32%|███▏      | 64/200 [00:00<00:01, 71.93it/s] 36%|███▌      | 72/200 [00:00<00:01, 72.03it/s] 40%|████      | 80/200 [00:01<00:01, 72.15it/s] 44%|████▍     | 88/200 [00:01<00:01, 71.87it/s] 48%|████▊     | 96/200 [00:01<00:01, 71.88it/s] 52%|█████▏    | 104/200 [00:01<00:01, 72.13it/s] 56%|█████▌    | 112/200 [00:01<00:01, 72.33it/s] 60%|██████    | 120/200 [00:01<00:01, 72.60it/s] 62%|██████▏   | 123/200 [00:01<00:01, 71.65it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▎         | 7/200 [00:00<00:02, 69.76it/s]  8%|▊         | 15/200 [00:00<00:02, 70.78it/s] 12%|█▏        | 23/200 [00:00<00:02, 71.46it/s] 16%|█▌        | 31/200 [00:00<00:02, 71.90it/s] 20%|█▉        | 39/200 [00:00<00:02, 72.10it/s] 24%|██▎       | 47/200 [00:00<00:02, 72.18it/s] 28%|██▊       | 55/200 [00:00<00:01, 72.53it/s] 32%|███▏      | 63/200 [00:00<00:01, 72.67it/s] 36%|███▌      | 71/200 [00:00<00:01, 72.96it/s] 40%|███▉      | 79/200 [00:01<00:01, 72.99it/s] 44%|████▎     | 87/200 [00:01<00:01, 72.82it/s] 48%|████▊     | 95/200 [00:01<00:01, 72.75it/s] 52%|█████▏    | 103/200 [00:01<00:01, 72.25it/s] 56%|█████▌    | 111/200 [00:01<00:01, 72.10it/s] 60%|█████▉    | 119/200 [00:01<00:01, 72.10it/s] 64%|██████▎   | 127/200 [00:01<00:01, 71.98it/s] 68%|██████▊   | 135/200 [00:01<00:00, 71.90it/s] 72%|███████▏  | 143/200 [00:01<00:00, 71.87it/s] 76%|███████▌  | 151/200 [00:02<00:00, 72.14it/s] 80%|███████▉  | 159/200 [00:02<00:00, 72.03it/s] 80%|███████▉  | 159/200 [00:02<00:00, 71.72it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▍         | 8/200 [00:00<00:02, 70.51it/s]  8%|▊         | 16/200 [00:00<00:02, 71.20it/s] 12%|█▏        | 24/200 [00:00<00:02, 71.54it/s] 16%|█▌        | 32/200 [00:00<00:02, 71.76it/s] 20%|██        | 40/200 [00:00<00:02, 72.28it/s] 24%|██▍       | 48/200 [00:00<00:02, 72.69it/s] 28%|██▊       | 56/200 [00:00<00:01, 72.97it/s] 32%|███▏      | 64/200 [00:00<00:01, 73.02it/s] 36%|███▌      | 72/200 [00:00<00:01, 73.08it/s] 40%|████      | 80/200 [00:01<00:01, 73.00it/s] 44%|████▍     | 88/200 [00:01<00:01, 72.69it/s] 48%|████▊     | 96/200 [00:01<00:01, 72.21it/s] 52%|█████▏    | 104/200 [00:01<00:01, 72.14it/s] 56%|█████▌    | 112/200 [00:01<00:01, 71.95it/s] 60%|██████    | 120/200 [00:01<00:01, 71.86it/s] 64%|██████▍   | 128/200 [00:01<00:00, 72.07it/s] 68%|██████▊   | 136/200 [00:01<00:00, 72.18it/s] 72%|███████▏  | 143/200 [00:01<00:00, 71.80it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▍         | 8/200 [00:00<00:02, 70.63it/s]  8%|▊         | 16/200 [00:00<00:02, 71.65it/s] 12%|█▏        | 24/200 [00:00<00:02, 72.25it/s] 16%|█▌        | 32/200 [00:00<00:02, 72.64it/s] 20%|██        | 40/200 [00:00<00:02, 72.80it/s] 24%|██▍       | 48/200 [00:00<00:02, 72.72it/s] 28%|██▊       | 56/200 [00:00<00:01, 72.89it/s] 32%|███▏      | 64/200 [00:00<00:01, 72.67it/s] 36%|███▌      | 72/200 [00:00<00:01, 73.80it/s] 40%|████      | 80/200 [00:01<00:01, 74.32it/s] 44%|████▍     | 88/200 [00:01<00:01, 75.03it/s] 48%|████▊     | 96/200 [00:01<00:01, 75.04it/s] 52%|█████▏    | 104/200 [00:01<00:01, 75.08it/s] 56%|█████▌    | 112/200 [00:01<00:01, 75.49it/s] 60%|██████    | 120/200 [00:01<00:01, 75.36it/s] 64%|██████▍   | 128/200 [00:01<00:00, 75.37it/s] 68%|██████▊   | 136/200 [00:01<00:00, 75.61it/s] 72%|███████▏  | 144/200 [00:01<00:00, 75.48it/s] 76%|███████▌  | 152/200 [00:02<00:00, 75.54it/s] 80%|████████  | 160/200 [00:02<00:00, 68.19it/s] 82%|████████▏ | 164/200 [00:02<00:00, 72.72it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▍         | 8/200 [00:00<00:02, 74.56it/s]  8%|▊         | 16/200 [00:00<00:02, 74.67it/s] 12%|█▏        | 24/200 [00:00<00:02, 75.29it/s] 16%|█▌        | 32/200 [00:00<00:02, 75.91it/s] 20%|██        | 40/200 [00:00<00:02, 75.87it/s] 24%|██▍       | 48/200 [00:00<00:02, 75.77it/s] 28%|██▊       | 56/200 [00:00<00:01, 75.86it/s] 32%|███▏      | 64/200 [00:00<00:01, 75.78it/s] 36%|███▌      | 72/200 [00:00<00:01, 75.71it/s] 40%|████      | 80/200 [00:01<00:01, 75.92it/s] 44%|████▍     | 88/200 [00:01<00:01, 76.11it/s] 48%|████▊     | 96/200 [00:01<00:01, 76.19it/s] 52%|█████▏    | 104/200 [00:01<00:01, 76.52it/s] 56%|█████▌    | 112/200 [00:01<00:01, 76.78it/s] 60%|██████    | 120/200 [00:01<00:01, 76.79it/s] 64%|██████▍   | 128/200 [00:01<00:00, 76.96it/s] 67%|██████▋   | 134/200 [00:01<00:00, 75.68it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▍         | 8/200 [00:00<00:02, 74.64it/s]  8%|▊         | 16/200 [00:00<00:02, 74.92it/s] 12%|█▏        | 24/200 [00:00<00:02, 75.08it/s] 16%|█▌        | 32/200 [00:00<00:02, 75.83it/s] 20%|██        | 40/200 [00:00<00:02, 75.67it/s] 24%|██▍       | 48/200 [00:00<00:02, 75.59it/s] 28%|██▊       | 56/200 [00:00<00:01, 75.43it/s] 32%|███▏      | 64/200 [00:00<00:01, 75.73it/s] 36%|███▌      | 72/200 [00:00<00:01, 75.73it/s] 40%|████      | 80/200 [00:01<00:01, 75.82it/s] 44%|████▍     | 88/200 [00:01<00:01, 75.90it/s] 48%|████▊     | 96/200 [00:01<00:01, 76.08it/s] 52%|█████▏    | 104/200 [00:01<00:01, 76.43it/s] 56%|█████▌    | 111/200 [00:01<00:01, 75.13it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▍         | 8/200 [00:00<00:02, 75.42it/s]  8%|▊         | 16/200 [00:00<00:02, 76.10it/s] 12%|█▏        | 24/200 [00:00<00:02, 76.21it/s] 16%|█▌        | 32/200 [00:00<00:02, 76.07it/s] 20%|██        | 40/200 [00:00<00:02, 76.13it/s] 24%|██▍       | 48/200 [00:00<00:01, 76.01it/s] 28%|██▊       | 56/200 [00:00<00:01, 76.01it/s] 32%|███▏      | 64/200 [00:00<00:01, 76.48it/s] 36%|███▌      | 72/200 [00:00<00:01, 76.59it/s] 40%|████      | 80/200 [00:01<00:01, 76.63it/s] 44%|████▍     | 88/200 [00:01<00:01, 76.54it/s] 48%|████▊     | 96/200 [00:01<00:01, 76.20it/s] 52%|█████▏    | 104/200 [00:01<00:01, 76.26it/s] 56%|█████▌    | 112/200 [00:01<00:01, 76.31it/s] 60%|██████    | 120/200 [00:01<00:01, 76.09it/s] 64%|██████▍   | 128/200 [00:01<00:00, 76.19it/s] 66%|██████▌   | 132/200 [00:01<00:00, 75.60it/s]
  0%|          | 0/2000 [00:00<?, ?it/s]100%|██████████| 2000/2000 [00:00<00:00, 63978.52it/s]
  Forget loss: 1.2014
  Retain loss: 1.2727
  Target words in generation: 12
  Mean repetition ratio: 0.034

======================================================================
EVALUATING: From-scratch (full_seq)
======================================================================
  Loading contracted model from debugging_demix...
  Running generation eval...
  0%|          | 0/200 [00:00<?, ?it/s]  3%|▎         | 6/200 [00:00<00:03, 52.94it/s]  6%|▌         | 12/200 [00:00<00:03, 56.03it/s] 10%|▉         | 19/200 [00:00<00:03, 57.98it/s] 13%|█▎        | 26/200 [00:00<00:02, 59.25it/s] 16%|█▋        | 33/200 [00:00<00:02, 60.18it/s] 20%|██        | 40/200 [00:00<00:02, 60.51it/s] 24%|██▎       | 47/200 [00:00<00:02, 60.59it/s] 27%|██▋       | 54/200 [00:00<00:02, 60.58it/s] 30%|███       | 61/200 [00:01<00:02, 60.43it/s] 34%|███▍      | 68/200 [00:01<00:02, 60.47it/s] 38%|███▊      | 75/200 [00:01<00:02, 60.47it/s] 41%|████      | 82/200 [00:01<00:01, 60.42it/s] 44%|████▍     | 89/200 [00:01<00:01, 60.62it/s] 48%|████▊     | 96/200 [00:01<00:01, 60.65it/s] 52%|█████▏    | 103/200 [00:01<00:01, 60.76it/s] 55%|█████▌    | 110/200 [00:01<00:01, 60.56it/s] 58%|█████▊    | 117/200 [00:01<00:01, 60.52it/s] 62%|██████▏   | 124/200 [00:02<00:01, 60.71it/s] 66%|██████▌   | 131/200 [00:02<00:01, 60.76it/s] 69%|██████▉   | 138/200 [00:02<00:01, 60.76it/s] 72%|███████▎  | 145/200 [00:02<00:00, 60.65it/s] 76%|███████▌  | 152/200 [00:02<00:00, 60.79it/s] 80%|███████▉  | 159/200 [00:02<00:00, 60.63it/s] 83%|████████▎ | 166/200 [00:02<00:00, 60.43it/s] 86%|████████▋ | 173/200 [00:02<00:00, 60.14it/s] 90%|█████████ | 180/200 [00:02<00:00, 60.05it/s] 94%|█████████▎| 187/200 [00:03<00:00, 59.92it/s] 97%|█████████▋| 194/200 [00:03<00:00, 60.13it/s]100%|██████████| 200/200 [00:03<00:00, 60.21it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  3%|▎         | 6/200 [00:00<00:03, 59.42it/s]  6%|▌         | 12/200 [00:00<00:03, 59.54it/s]  9%|▉         | 18/200 [00:00<00:03, 59.52it/s] 12%|█▏        | 24/200 [00:00<00:02, 59.65it/s] 15%|█▌        | 30/200 [00:00<00:02, 59.64it/s] 18%|█▊        | 36/200 [00:00<00:02, 59.69it/s] 21%|██        | 42/200 [00:00<00:02, 59.54it/s] 24%|██▍       | 48/200 [00:00<00:02, 59.58it/s] 27%|██▋       | 54/200 [00:00<00:02, 59.70it/s] 30%|███       | 61/200 [00:01<00:02, 59.93it/s] 34%|███▎      | 67/200 [00:01<00:02, 59.78it/s] 36%|███▋      | 73/200 [00:01<00:02, 59.61it/s] 40%|████      | 80/200 [00:01<00:01, 60.12it/s] 44%|████▎     | 87/200 [00:01<00:01, 60.03it/s] 47%|████▋     | 94/200 [00:01<00:01, 59.80it/s] 50%|█████     | 100/200 [00:01<00:01, 59.69it/s] 53%|█████▎    | 106/200 [00:01<00:01, 59.70it/s] 56%|█████▌    | 112/200 [00:01<00:01, 59.73it/s] 59%|█████▉    | 118/200 [00:01<00:01, 59.46it/s] 62%|██████▏   | 124/200 [00:02<00:01, 59.38it/s] 66%|██████▌   | 131/200 [00:02<00:01, 59.71it/s] 68%|██████▊   | 137/200 [00:02<00:01, 59.79it/s] 72%|███████▏  | 143/200 [00:02<00:00, 59.77it/s] 74%|███████▍  | 149/200 [00:02<00:00, 59.63it/s] 78%|███████▊  | 155/200 [00:02<00:00, 59.48it/s] 80%|████████  | 161/200 [00:02<00:00, 59.36it/s] 84%|████████▎ | 167/200 [00:02<00:00, 59.48it/s] 86%|████████▋ | 173/200 [00:02<00:00, 59.56it/s] 90%|████████▉ | 179/200 [00:03<00:00, 59.54it/s] 92%|█████████▎| 185/200 [00:03<00:00, 59.62it/s] 96%|█████████▌| 191/200 [00:03<00:00, 59.39it/s] 98%|█████████▊| 197/200 [00:03<00:00, 59.41it/s]100%|██████████| 200/200 [00:03<00:00, 59.62it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  3%|▎         | 6/200 [00:00<00:03, 57.67it/s]  6%|▌         | 12/200 [00:00<00:03, 57.78it/s]  9%|▉         | 18/200 [00:00<00:03, 58.24it/s] 12%|█▏        | 24/200 [00:00<00:02, 58.80it/s] 16%|█▌        | 31/200 [00:00<00:02, 59.37it/s] 18%|█▊        | 37/200 [00:00<00:02, 59.50it/s] 22%|██▏       | 43/200 [00:00<00:02, 59.28it/s] 24%|██▍       | 49/200 [00:00<00:02, 59.22it/s] 28%|██▊       | 55/200 [00:00<00:02, 59.13it/s] 30%|███       | 61/200 [00:01<00:02, 59.16it/s] 34%|███▎      | 67/200 [00:01<00:02, 59.22it/s] 36%|███▋      | 73/200 [00:01<00:02, 59.30it/s] 40%|███▉      | 79/200 [00:01<00:02, 59.32it/s] 43%|████▎     | 86/200 [00:01<00:01, 59.62it/s] 46%|████▋     | 93/200 [00:01<00:01, 59.81it/s] 50%|█████     | 100/200 [00:01<00:01, 59.97it/s] 53%|█████▎    | 106/200 [00:01<00:01, 59.75it/s] 56%|█████▌    | 112/200 [00:01<00:01, 59.76it/s] 60%|█████▉    | 119/200 [00:02<00:01, 59.84it/s] 62%|██████▎   | 125/200 [00:02<00:01, 59.53it/s] 66%|██████▌   | 131/200 [00:02<00:01, 59.51it/s] 68%|██████▊   | 137/200 [00:02<00:01, 59.50it/s] 72%|███████▏  | 143/200 [00:02<00:00, 59.52it/s] 75%|███████▌  | 150/200 [00:02<00:00, 59.75it/s] 78%|███████▊  | 156/200 [00:02<00:00, 59.53it/s] 82%|████████▏ | 163/200 [00:02<00:00, 59.71it/s] 84%|████████▍ | 169/200 [00:02<00:00, 59.56it/s] 88%|████████▊ | 175/200 [00:02<00:00, 59.62it/s] 90%|█████████ | 181/200 [00:03<00:00, 59.64it/s] 94%|█████████▎| 187/200 [00:03<00:00, 59.71it/s] 96%|█████████▋| 193/200 [00:03<00:00, 59.69it/s]100%|█████████▉| 199/200 [00:03<00:00, 59.68it/s]100%|██████████| 200/200 [00:03<00:00, 59.47it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  3%|▎         | 6/200 [00:00<00:03, 58.37it/s]  6%|▌         | 12/200 [00:00<00:03, 58.73it/s]  9%|▉         | 18/200 [00:00<00:03, 58.83it/s] 12%|█▏        | 24/200 [00:00<00:02, 58.79it/s] 15%|█▌        | 30/200 [00:00<00:02, 58.80it/s] 18%|█▊        | 36/200 [00:00<00:02, 58.97it/s] 21%|██        | 42/200 [00:00<00:02, 59.14it/s] 24%|██▍       | 48/200 [00:00<00:02, 59.19it/s] 27%|██▋       | 54/200 [00:00<00:02, 59.42it/s] 30%|███       | 60/200 [00:01<00:02, 59.08it/s] 33%|███▎      | 66/200 [00:01<00:02, 59.14it/s] 36%|███▌      | 72/200 [00:01<00:02, 59.34it/s] 39%|███▉      | 78/200 [00:01<00:02, 59.15it/s] 42%|████▏     | 84/200 [00:01<00:01, 58.79it/s] 45%|████▌     | 90/200 [00:01<00:01, 58.62it/s] 48%|████▊     | 96/200 [00:01<00:01, 58.74it/s] 51%|█████     | 102/200 [00:01<00:01, 59.10it/s] 54%|█████▍    | 108/200 [00:01<00:01, 59.21it/s] 57%|█████▋    | 114/200 [00:01<00:01, 59.13it/s] 60%|██████    | 120/200 [00:02<00:01, 59.26it/s] 63%|██████▎   | 126/200 [00:02<00:01, 59.29it/s] 66%|██████▌   | 132/200 [00:02<00:01, 59.25it/s] 69%|██████▉   | 138/200 [00:02<00:01, 59.38it/s] 72%|███████▏  | 144/200 [00:02<00:00, 59.30it/s] 75%|███████▌  | 150/200 [00:02<00:00, 59.25it/s] 78%|███████▊  | 156/200 [00:02<00:00, 59.32it/s] 81%|████████  | 162/200 [00:02<00:00, 59.31it/s] 84%|████████▍ | 168/200 [00:02<00:00, 59.16it/s] 87%|████████▋ | 174/200 [00:02<00:00, 59.25it/s] 90%|█████████ | 180/200 [00:03<00:00, 59.19it/s] 93%|█████████▎| 186/200 [00:03<00:00, 59.11it/s] 96%|█████████▌| 192/200 [00:03<00:00, 59.20it/s] 99%|█████████▉| 198/200 [00:03<00:00, 59.35it/s]100%|██████████| 200/200 [00:03<00:00, 59.13it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  3%|▎         | 6/200 [00:00<00:03, 58.43it/s]  6%|▌         | 12/200 [00:00<00:03, 58.66it/s]  9%|▉         | 18/200 [00:00<00:03, 59.18it/s] 12%|█▎        | 25/200 [00:00<00:02, 59.74it/s] 16%|█▌        | 32/200 [00:00<00:02, 59.85it/s] 19%|█▉        | 38/200 [00:00<00:02, 59.80it/s] 22%|██▏       | 44/200 [00:00<00:02, 59.65it/s] 25%|██▌       | 50/200 [00:00<00:02, 59.69it/s] 28%|██▊       | 56/200 [00:00<00:02, 59.66it/s] 31%|███       | 62/200 [00:01<00:02, 59.50it/s] 34%|███▍      | 68/200 [00:01<00:02, 59.31it/s] 37%|███▋      | 74/200 [00:01<00:02, 59.26it/s] 40%|████      | 80/200 [00:01<00:02, 59.41it/s] 43%|████▎     | 86/200 [00:01<00:01, 59.58it/s] 46%|████▌     | 92/200 [00:01<00:01, 59.66it/s] 49%|████▉     | 98/200 [00:01<00:01, 59.41it/s] 52%|█████▏    | 104/200 [00:01<00:01, 59.14it/s] 55%|█████▌    | 110/200 [00:01<00:01, 59.07it/s] 58%|█████▊    | 116/200 [00:01<00:01, 58.97it/s] 61%|██████    | 122/200 [00:02<00:01, 58.96it/s] 64%|██████▍   | 128/200 [00:02<00:01, 58.73it/s] 67%|██████▋   | 134/200 [00:02<00:01, 58.89it/s] 70%|███████   | 141/200 [00:02<00:00, 59.33it/s] 74%|███████▎  | 147/200 [00:02<00:00, 59.30it/s] 76%|███████▋  | 153/200 [00:02<00:00, 59.07it/s] 80%|███████▉  | 159/200 [00:02<00:00, 58.85it/s] 82%|████████▎ | 165/200 [00:02<00:00, 58.65it/s] 86%|████████▌ | 171/200 [00:02<00:00, 58.42it/s] 88%|████████▊ | 177/200 [00:02<00:00, 58.47it/s] 92%|█████████▏| 183/200 [00:03<00:00, 58.24it/s] 94%|█████████▍| 189/200 [00:03<00:00, 58.18it/s] 98%|█████████▊| 195/200 [00:03<00:00, 58.15it/s]100%|██████████| 200/200 [00:03<00:00, 59.02it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  3%|▎         | 6/200 [00:00<00:03, 57.69it/s]  6%|▌         | 12/200 [00:00<00:03, 57.94it/s]  9%|▉         | 18/200 [00:00<00:03, 58.43it/s] 12%|█▏        | 24/200 [00:00<00:03, 58.51it/s] 15%|█▌        | 30/200 [00:00<00:02, 58.64it/s] 18%|█▊        | 36/200 [00:00<00:02, 58.63it/s] 21%|██        | 42/200 [00:00<00:02, 58.66it/s] 24%|██▍       | 48/200 [00:00<00:02, 58.75it/s] 27%|██▋       | 54/200 [00:00<00:02, 58.78it/s] 30%|███       | 60/200 [00:01<00:02, 58.79it/s] 33%|███▎      | 66/200 [00:01<00:02, 58.77it/s] 36%|███▌      | 72/200 [00:01<00:02, 58.60it/s] 39%|███▉      | 78/200 [00:01<00:02, 58.61it/s] 42%|████▏     | 84/200 [00:01<00:01, 58.44it/s] 45%|████▌     | 90/200 [00:01<00:01, 58.42it/s] 48%|████▊     | 96/200 [00:01<00:01, 58.62it/s] 51%|█████     | 102/200 [00:01<00:01, 58.63it/s] 54%|█████▍    | 108/200 [00:01<00:01, 58.97it/s] 57%|█████▋    | 114/200 [00:01<00:01, 58.75it/s] 60%|██████    | 120/200 [00:02<00:01, 58.57it/s] 63%|██████▎   | 126/200 [00:02<00:01, 58.46it/s] 66%|██████▌   | 132/200 [00:02<00:01, 58.23it/s] 69%|██████▉   | 138/200 [00:02<00:01, 58.23it/s] 72%|███████▏  | 144/200 [00:02<00:00, 58.24it/s] 75%|███████▌  | 150/200 [00:02<00:00, 58.29it/s] 78%|███████▊  | 156/200 [00:02<00:00, 58.40it/s] 81%|████████  | 162/200 [00:02<00:00, 58.37it/s] 84%|████████▍ | 168/200 [00:02<00:00, 58.32it/s] 87%|████████▋ | 174/200 [00:02<00:00, 58.17it/s] 90%|█████████ | 180/200 [00:03<00:00, 58.41it/s] 93%|█████████▎| 186/200 [00:03<00:00, 58.47it/s] 96%|█████████▌| 192/200 [00:03<00:00, 58.48it/s] 99%|█████████▉| 198/200 [00:03<00:00, 58.48it/s]100%|██████████| 200/200 [00:03<00:00, 58.49it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  3%|▎         | 6/200 [00:00<00:03, 58.48it/s]  6%|▌         | 12/200 [00:00<00:03, 59.10it/s]  9%|▉         | 18/200 [00:00<00:03, 59.46it/s] 12%|█▏        | 24/200 [00:00<00:02, 59.40it/s] 15%|█▌        | 30/200 [00:00<00:02, 59.21it/s] 18%|█▊        | 36/200 [00:00<00:02, 59.01it/s] 21%|██        | 42/200 [00:00<00:02, 58.98it/s] 24%|██▍       | 48/200 [00:00<00:02, 58.82it/s] 27%|██▋       | 54/200 [00:00<00:02, 58.89it/s] 30%|███       | 60/200 [00:01<00:02, 58.87it/s] 33%|███▎      | 66/200 [00:01<00:02, 58.98it/s] 36%|███▌      | 72/200 [00:01<00:02, 59.26it/s] 39%|███▉      | 78/200 [00:01<00:02, 59.35it/s] 42%|████▏     | 84/200 [00:01<00:01, 59.42it/s] 45%|████▌     | 90/200 [00:01<00:01, 59.22it/s] 48%|████▊     | 96/200 [00:01<00:01, 58.91it/s] 51%|█████     | 102/200 [00:01<00:01, 58.84it/s] 54%|█████▍    | 108/200 [00:01<00:01, 58.80it/s] 57%|█████▋    | 114/200 [00:01<00:01, 58.68it/s] 60%|██████    | 120/200 [00:02<00:01, 58.54it/s] 63%|██████▎   | 126/200 [00:02<00:01, 58.31it/s] 66%|██████▌   | 132/200 [00:02<00:01, 58.34it/s] 69%|██████▉   | 138/200 [00:02<00:01, 58.18it/s] 72%|███████▏  | 144/200 [00:02<00:00, 57.93it/s] 75%|███████▌  | 150/200 [00:02<00:00, 58.08it/s] 78%|███████▊  | 156/200 [00:02<00:00, 57.93it/s] 81%|████████  | 162/200 [00:02<00:00, 57.87it/s] 84%|████████▍ | 168/200 [00:02<00:00, 58.13it/s] 87%|████████▋ | 174/200 [00:02<00:00, 58.13it/s] 90%|█████████ | 180/200 [00:03<00:00, 58.26it/s] 93%|█████████▎| 186/200 [00:03<00:00, 58.21it/s] 96%|█████████▌| 192/200 [00:03<00:00, 58.09it/s] 99%|█████████▉| 198/200 [00:03<00:00, 58.09it/s]100%|██████████| 200/200 [00:03<00:00, 58.60it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  3%|▎         | 6/200 [00:00<00:03, 57.48it/s]  6%|▌         | 12/200 [00:00<00:03, 57.28it/s]  9%|▉         | 18/200 [00:00<00:03, 57.35it/s] 12%|█▏        | 24/200 [00:00<00:03, 57.42it/s] 15%|█▌        | 30/200 [00:00<00:02, 57.58it/s] 18%|█▊        | 36/200 [00:00<00:02, 57.56it/s] 21%|██        | 42/200 [00:00<00:02, 57.57it/s] 24%|██▍       | 48/200 [00:00<00:02, 57.62it/s] 27%|██▋       | 54/200 [00:00<00:02, 57.69it/s] 30%|███       | 60/200 [00:01<00:02, 58.08it/s] 33%|███▎      | 66/200 [00:01<00:02, 57.97it/s] 36%|███▌      | 72/200 [00:01<00:02, 57.94it/s] 39%|███▉      | 78/200 [00:01<00:02, 57.87it/s] 42%|████▏     | 84/200 [00:01<00:02, 57.70it/s] 45%|████▌     | 90/200 [00:01<00:01, 57.68it/s] 48%|████▊     | 96/200 [00:01<00:01, 57.61it/s] 51%|█████     | 102/200 [00:01<00:01, 57.69it/s] 54%|█████▍    | 108/200 [00:01<00:01, 57.62it/s] 57%|█████▋    | 114/200 [00:01<00:01, 57.82it/s] 60%|██████    | 120/200 [00:02<00:01, 58.07it/s] 63%|██████▎   | 126/200 [00:02<00:01, 58.20it/s] 66%|██████▌   | 132/200 [00:02<00:01, 58.28it/s] 69%|██████▉   | 138/200 [00:02<00:01, 58.35it/s] 72%|███████▏  | 144/200 [00:02<00:00, 58.73it/s] 75%|███████▌  | 150/200 [00:02<00:00, 58.76it/s] 78%|███████▊  | 156/200 [00:02<00:00, 58.82it/s] 81%|████████  | 162/200 [00:02<00:00, 58.61it/s] 84%|████████▍ | 168/200 [00:02<00:00, 58.60it/s] 87%|████████▋ | 174/200 [00:02<00:00, 58.58it/s] 90%|█████████ | 180/200 [00:03<00:00, 58.63it/s] 93%|█████████▎| 186/200 [00:03<00:00, 58.27it/s] 96%|█████████▌| 192/200 [00:03<00:00, 58.01it/s] 99%|█████████▉| 198/200 [00:03<00:00, 57.94it/s]100%|██████████| 200/200 [00:03<00:00, 58.01it/s]
  Computing validation losses...
  0%|          | 0/2000 [00:00<?, ?it/s]100%|██████████| 2000/2000 [00:00<00:00, 63686.60it/s]
  Loading expanded model for activation analysis...
  Running activation analysis...
  0%|          | 0/1000 [00:00<?, ?it/s]100%|██████████| 1000/1000 [00:00<00:00, 63539.47it/s]
  Training losses: {'pre_ablation': {'forget_loss': 1.4679316282272339, 'retain_loss': 1.5644601583480835}, 'post_ablation': {'forget_loss': 3.2472310066223145, 'retain_loss': 2.023167848587036}}
  Validation forget loss: 3.3227
  Validation retain loss: 2.088
  Target words in generation: 1
  Mean repetition: 0.046
  layer_0: forget/retain expanded ratio = 2.99x
  layer_1: forget/retain expanded ratio = 3.53x
  layer_2: forget/retain expanded ratio = 1.62x
  layer_3: forget/retain expanded ratio = 1.38x
  layer_4: forget/retain expanded ratio = 1.26x

======================================================================
EVALUATING: Post-training (full_seq)
======================================================================
  Loading contracted model from posttrain_results...
  Running generation eval...
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▎         | 7/200 [00:00<00:02, 64.51it/s]  7%|▋         | 14/200 [00:00<00:02, 66.98it/s] 10%|█         | 21/200 [00:00<00:02, 68.11it/s] 14%|█▍        | 28/200 [00:00<00:02, 68.64it/s] 18%|█▊        | 36/200 [00:00<00:02, 69.54it/s] 22%|██▏       | 44/200 [00:00<00:02, 70.05it/s] 26%|██▌       | 52/200 [00:00<00:02, 70.38it/s] 30%|███       | 60/200 [00:00<00:01, 70.38it/s] 34%|███▍      | 68/200 [00:00<00:01, 70.28it/s] 38%|███▊      | 76/200 [00:01<00:01, 70.26it/s] 42%|████▏     | 84/200 [00:01<00:01, 70.42it/s] 46%|████▌     | 92/200 [00:01<00:01, 70.44it/s] 50%|█████     | 100/200 [00:01<00:01, 70.64it/s] 54%|█████▍    | 108/200 [00:01<00:01, 70.62it/s] 58%|█████▊    | 116/200 [00:01<00:01, 70.61it/s] 62%|██████▏   | 124/200 [00:01<00:01, 70.71it/s] 66%|██████▌   | 132/200 [00:01<00:00, 70.78it/s] 70%|███████   | 140/200 [00:01<00:00, 70.82it/s] 74%|███████▍  | 148/200 [00:02<00:00, 71.04it/s] 78%|███████▊  | 156/200 [00:02<00:00, 70.76it/s] 82%|████████▏ | 164/200 [00:02<00:00, 70.66it/s] 86%|████████▌ | 172/200 [00:02<00:00, 70.84it/s] 90%|█████████ | 180/200 [00:02<00:00, 71.04it/s] 94%|█████████▍| 188/200 [00:02<00:00, 70.95it/s] 98%|█████████▊| 196/200 [00:02<00:00, 70.99it/s]100%|██████████| 200/200 [00:02<00:00, 70.38it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▎         | 7/200 [00:00<00:02, 69.74it/s]  8%|▊         | 15/200 [00:00<00:02, 70.28it/s] 12%|█▏        | 23/200 [00:00<00:02, 70.81it/s] 16%|█▌        | 31/200 [00:00<00:02, 71.09it/s] 20%|█▉        | 39/200 [00:00<00:02, 71.06it/s] 24%|██▎       | 47/200 [00:00<00:02, 71.23it/s] 28%|██▊       | 55/200 [00:00<00:02, 71.31it/s] 32%|███▏      | 63/200 [00:00<00:01, 71.46it/s] 36%|███▌      | 71/200 [00:00<00:01, 71.62it/s] 40%|███▉      | 79/200 [00:01<00:01, 71.45it/s] 44%|████▎     | 87/200 [00:01<00:01, 71.36it/s] 48%|████▊     | 95/200 [00:01<00:01, 71.36it/s] 52%|█████▏    | 103/200 [00:01<00:01, 71.44it/s] 56%|█████▌    | 111/200 [00:01<00:01, 71.39it/s] 60%|█████▉    | 119/200 [00:01<00:01, 71.41it/s] 64%|██████▎   | 127/200 [00:01<00:01, 71.05it/s] 68%|██████▊   | 135/200 [00:01<00:00, 71.01it/s] 72%|███████▏  | 143/200 [00:02<00:00, 70.78it/s] 76%|███████▌  | 151/200 [00:02<00:00, 70.70it/s] 80%|███████▉  | 159/200 [00:02<00:00, 70.59it/s] 84%|████████▎ | 167/200 [00:02<00:00, 70.71it/s] 88%|████████▊ | 175/200 [00:02<00:00, 70.62it/s] 92%|█████████▏| 183/200 [00:02<00:00, 70.52it/s] 96%|█████████▌| 191/200 [00:02<00:00, 70.51it/s]100%|█████████▉| 199/200 [00:02<00:00, 70.36it/s]100%|██████████| 200/200 [00:02<00:00, 70.93it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▎         | 7/200 [00:00<00:02, 68.38it/s]  7%|▋         | 14/200 [00:00<00:02, 68.92it/s] 10%|█         | 21/200 [00:00<00:02, 69.08it/s] 14%|█▍        | 28/200 [00:00<00:02, 69.18it/s] 18%|█▊        | 35/200 [00:00<00:02, 69.17it/s] 21%|██        | 42/200 [00:00<00:02, 69.34it/s] 25%|██▌       | 50/200 [00:00<00:02, 69.61it/s] 28%|██▊       | 57/200 [00:00<00:02, 69.70it/s] 32%|███▎      | 65/200 [00:00<00:01, 69.90it/s] 36%|███▋      | 73/200 [00:01<00:01, 70.27it/s] 40%|████      | 81/200 [00:01<00:01, 70.22it/s] 44%|████▍     | 89/200 [00:01<00:01, 70.39it/s] 48%|████▊     | 97/200 [00:01<00:01, 70.29it/s] 52%|█████▎    | 105/200 [00:01<00:01, 70.13it/s] 56%|█████▋    | 113/200 [00:01<00:01, 69.97it/s] 60%|██████    | 120/200 [00:01<00:01, 69.93it/s] 64%|██████▍   | 128/200 [00:01<00:01, 70.27it/s] 68%|██████▊   | 136/200 [00:01<00:00, 70.44it/s] 72%|███████▏  | 144/200 [00:02<00:00, 70.77it/s] 76%|███████▌  | 152/200 [00:02<00:00, 71.19it/s] 80%|████████  | 160/200 [00:02<00:00, 71.33it/s] 84%|████████▍ | 168/200 [00:02<00:00, 71.59it/s] 88%|████████▊ | 176/200 [00:02<00:00, 71.63it/s] 92%|█████████▏| 184/200 [00:02<00:00, 71.56it/s] 96%|█████████▌| 192/200 [00:02<00:00, 71.43it/s]100%|██████████| 200/200 [00:02<00:00, 71.42it/s]100%|██████████| 200/200 [00:02<00:00, 70.48it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▍         | 8/200 [00:00<00:02, 70.71it/s]  8%|▊         | 16/200 [00:00<00:02, 70.63it/s] 12%|█▏        | 24/200 [00:00<00:02, 70.82it/s] 16%|█▌        | 32/200 [00:00<00:02, 71.10it/s] 20%|██        | 40/200 [00:00<00:02, 71.30it/s] 24%|██▍       | 48/200 [00:00<00:02, 71.38it/s] 28%|██▊       | 56/200 [00:00<00:02, 71.46it/s] 32%|███▏      | 64/200 [00:00<00:01, 71.34it/s] 36%|███▌      | 72/200 [00:01<00:01, 71.39it/s] 40%|████      | 80/200 [00:01<00:01, 71.44it/s] 44%|████▍     | 88/200 [00:01<00:01, 71.17it/s] 48%|████▊     | 96/200 [00:01<00:01, 71.19it/s] 52%|█████▏    | 104/200 [00:01<00:01, 71.18it/s] 56%|█████▌    | 112/200 [00:01<00:01, 71.08it/s] 60%|██████    | 120/200 [00:01<00:01, 71.24it/s] 64%|██████▍   | 128/200 [00:01<00:01, 71.16it/s] 68%|██████▊   | 136/200 [00:01<00:00, 71.06it/s] 72%|███████▏  | 144/200 [00:02<00:00, 70.98it/s] 76%|███████▌  | 152/200 [00:02<00:00, 70.99it/s] 80%|████████  | 160/200 [00:02<00:00, 71.47it/s] 84%|████████▍ | 168/200 [00:02<00:00, 71.66it/s] 88%|████████▊ | 176/200 [00:02<00:00, 71.66it/s] 92%|█████████▏| 184/200 [00:02<00:00, 71.51it/s] 96%|█████████▌| 192/200 [00:02<00:00, 71.69it/s]100%|██████████| 200/200 [00:02<00:00, 71.78it/s]100%|██████████| 200/200 [00:02<00:00, 71.33it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▎         | 7/200 [00:00<00:02, 69.64it/s]  8%|▊         | 15/200 [00:00<00:02, 70.54it/s] 12%|█▏        | 23/200 [00:00<00:02, 71.07it/s] 16%|█▌        | 31/200 [00:00<00:02, 71.16it/s] 20%|█▉        | 39/200 [00:00<00:02, 71.51it/s] 24%|██▎       | 47/200 [00:00<00:02, 71.43it/s] 28%|██▊       | 55/200 [00:00<00:02, 71.26it/s] 32%|███▏      | 63/200 [00:00<00:01, 71.42it/s] 36%|███▌      | 71/200 [00:00<00:01, 71.57it/s] 40%|███▉      | 79/200 [00:01<00:01, 71.22it/s] 44%|████▎     | 87/200 [00:01<00:01, 71.12it/s] 48%|████▊     | 95/200 [00:01<00:01, 71.23it/s] 52%|█████▏    | 103/200 [00:01<00:01, 71.20it/s] 56%|█████▌    | 111/200 [00:01<00:01, 71.31it/s] 60%|█████▉    | 119/200 [00:01<00:01, 71.55it/s] 64%|██████▎   | 127/200 [00:01<00:01, 71.40it/s] 68%|██████▊   | 135/200 [00:01<00:00, 71.08it/s] 72%|███████▏  | 143/200 [00:02<00:00, 71.12it/s] 76%|███████▌  | 151/200 [00:02<00:00, 71.41it/s] 80%|███████▉  | 159/200 [00:02<00:00, 71.76it/s] 84%|████████▎ | 167/200 [00:02<00:00, 71.56it/s] 88%|████████▊ | 175/200 [00:02<00:00, 71.62it/s] 92%|█████████▏| 183/200 [00:02<00:00, 71.29it/s] 96%|█████████▌| 191/200 [00:02<00:00, 71.16it/s]100%|█████████▉| 199/200 [00:02<00:00, 71.02it/s]100%|██████████| 200/200 [00:02<00:00, 71.25it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▎         | 7/200 [00:00<00:02, 69.34it/s]  8%|▊         | 15/200 [00:00<00:02, 70.40it/s] 12%|█▏        | 23/200 [00:00<00:02, 70.88it/s] 16%|█▌        | 31/200 [00:00<00:02, 71.08it/s] 20%|█▉        | 39/200 [00:00<00:02, 71.30it/s] 24%|██▎       | 47/200 [00:00<00:02, 71.30it/s] 28%|██▊       | 55/200 [00:00<00:02, 71.25it/s] 32%|███▏      | 63/200 [00:00<00:01, 70.98it/s] 36%|███▌      | 71/200 [00:01<00:01, 71.00it/s] 40%|███▉      | 79/200 [00:01<00:01, 70.90it/s] 44%|████▎     | 87/200 [00:01<00:01, 70.84it/s] 48%|████▊     | 95/200 [00:01<00:01, 70.77it/s] 52%|█████▏    | 103/200 [00:01<00:01, 71.06it/s] 56%|█████▌    | 111/200 [00:01<00:01, 71.13it/s] 60%|█████▉    | 119/200 [00:01<00:01, 71.30it/s] 64%|██████▎   | 127/200 [00:01<00:01, 71.47it/s] 68%|██████▊   | 135/200 [00:01<00:00, 71.29it/s] 72%|███████▏  | 143/200 [00:02<00:00, 71.44it/s] 76%|███████▌  | 151/200 [00:02<00:00, 71.55it/s] 80%|███████▉  | 159/200 [00:02<00:00, 71.75it/s] 84%|████████▎ | 167/200 [00:02<00:00, 71.77it/s] 88%|████████▊ | 175/200 [00:02<00:00, 71.82it/s] 92%|█████████▏| 183/200 [00:02<00:00, 71.70it/s] 96%|█████████▌| 191/200 [00:02<00:00, 71.78it/s]100%|█████████▉| 199/200 [00:02<00:00, 71.75it/s]100%|██████████| 200/200 [00:02<00:00, 71.32it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▍         | 8/200 [00:00<00:02, 70.85it/s]  8%|▊         | 16/200 [00:00<00:02, 70.96it/s] 12%|█▏        | 24/200 [00:00<00:02, 71.39it/s] 16%|█▌        | 32/200 [00:00<00:02, 71.50it/s] 20%|██        | 40/200 [00:00<00:02, 71.55it/s] 24%|██▍       | 48/200 [00:00<00:02, 71.81it/s] 28%|██▊       | 56/200 [00:00<00:02, 71.81it/s] 32%|███▏      | 64/200 [00:00<00:01, 71.53it/s] 36%|███▌      | 72/200 [00:01<00:01, 71.55it/s] 40%|████      | 80/200 [00:01<00:01, 71.33it/s] 44%|████▍     | 88/200 [00:01<00:01, 71.26it/s] 48%|████▊     | 96/200 [00:01<00:01, 71.24it/s] 52%|█████▏    | 104/200 [00:01<00:01, 71.16it/s] 56%|█████▌    | 112/200 [00:01<00:01, 71.19it/s] 60%|██████    | 120/200 [00:01<00:01, 71.67it/s] 64%|██████▍   | 128/200 [00:01<00:01, 71.77it/s] 68%|██████▊   | 136/200 [00:01<00:00, 71.66it/s] 72%|███████▏  | 144/200 [00:02<00:00, 71.45it/s] 76%|███████▌  | 152/200 [00:02<00:00, 71.45it/s] 80%|████████  | 160/200 [00:02<00:00, 71.31it/s] 84%|████████▍ | 168/200 [00:02<00:00, 71.32it/s] 88%|████████▊ | 176/200 [00:02<00:00, 71.29it/s] 92%|█████████▏| 184/200 [00:02<00:00, 71.24it/s] 96%|█████████▌| 192/200 [00:02<00:00, 71.57it/s]100%|██████████| 200/200 [00:02<00:00, 71.53it/s]100%|██████████| 200/200 [00:02<00:00, 71.44it/s]
  0%|          | 0/200 [00:00<?, ?it/s]  4%|▍         | 8/200 [00:00<00:02, 70.78it/s]  8%|▊         | 16/200 [00:00<00:02, 70.72it/s] 12%|█▏        | 24/200 [00:00<00:02, 70.90it/s] 16%|█▌        | 32/200 [00:00<00:02, 71.14it/s] 20%|██        | 40/200 [00:00<00:02, 71.27it/s] 24%|██▍       | 48/200 [00:00<00:02, 71.36it/s] 28%|██▊       | 56/200 [00:00<00:02, 71.41it/s] 32%|███▏      | 64/200 [00:00<00:01, 71.55it/s] 36%|███▌      | 72/200 [00:01<00:01, 71.45it/s] 40%|████      | 80/200 [00:01<00:01, 71.19it/s] 44%|████▍     | 88/200 [00:01<00:01, 71.04it/s] 48%|████▊     | 96/200 [00:01<00:01, 70.82it/s] 52%|█████▏    | 104/200 [00:01<00:01, 71.09it/s] 56%|█████▌    | 112/200 [00:01<00:01, 71.31it/s] 60%|██████    | 120/200 [00:01<00:01, 71.10it/s] 64%|██████▍   | 128/200 [00:01<00:01, 70.87it/s] 68%|██████▊   | 136/200 [00:01<00:00, 70.69it/s] 72%|███████▏  | 144/200 [00:02<00:00, 70.59it/s] 76%|███████▌  | 152/200 [00:02<00:00, 70.72it/s] 80%|████████  | 160/200 [00:02<00:00, 70.99it/s] 84%|████████▍ | 168/200 [00:02<00:00, 71.33it/s] 88%|████████▊ | 176/200 [00:02<00:00, 71.53it/s] 92%|█████████▏| 184/200 [00:02<00:00, 71.39it/s] 96%|█████████▌| 192/200 [00:02<00:00, 71.47it/s]100%|██████████| 200/200 [00:02<00:00, 71.63it/s]100%|██████████| 200/200 [00:02<00:00, 71.19it/s]
  Computing validation losses...
  0%|          | 0/2000 [00:00<?, ?it/s]100%|██████████| 2000/2000 [00:00<00:00, 63758.73it/s]
  Loading expanded model for activation analysis...
  Running activation analysis...
  0%|          | 0/1000 [00:00<?, ?it/s]100%|██████████| 1000/1000 [00:00<00:00, 63633.94it/s]
  Training losses: {'pre_ablation': {'forget_loss': 1.0864829421043396, 'retain_loss': 1.0791699886322021}, 'post_ablation': {'forget_loss': 1.3459745645523071, 'retain_loss': 1.1048822402954102}}
  Validation forget loss: 1.3366
  Validation retain loss: 1.1223
  Target words in generation: 6
  Mean repetition: 0.027
  layer_0: forget/retain expanded ratio = 1.83x
  layer_1: forget/retain expanded ratio = 1.44x
  layer_2: forget/retain expanded ratio = 1.25x
  layer_3: forget/retain expanded ratio = 1.25x
  layer_4: forget/retain expanded ratio = 1.06x

======================================================================
TOKEN ROUTING WEIGHT ANALYSIS
======================================================================
  0%|          | 0/200000 [00:00<?, ?it/s]  3%|▎         | 6524/200000 [00:00<00:02, 65236.95it/s]  7%|▋         | 13118/200000 [00:00<00:02, 65648.24it/s] 10%|▉         | 19769/200000 [00:00<00:02, 66037.73it/s] 13%|█▎        | 26373/200000 [00:00<00:02, 65916.24it/s] 16%|█▋        | 32965/200000 [00:00<00:02, 65682.76it/s] 20%|█▉        | 39536/200000 [00:00<00:02, 65689.47it/s] 23%|██▎       | 46130/200000 [00:00<00:02, 65766.41it/s] 26%|██▋       | 52776/200000 [00:00<00:02, 65984.90it/s] 30%|██▉       | 59375/200000 [00:00<00:02, 65797.81it/s] 33%|███▎      | 65955/200000 [00:01<00:02, 65767.65it/s] 36%|███▋      | 72532/200000 [00:01<00:01, 65750.29it/s] 40%|███▉      | 79108/200000 [00:01<00:01, 65544.78it/s] 43%|████▎     | 85712/200000 [00:01<00:01, 65691.89it/s] 46%|████▌     | 92282/200000 [00:01<00:01, 65640.13it/s] 49%|████▉     | 98856/200000 [00:01<00:01, 65667.26it/s] 53%|█████▎    | 105426/200000 [00:01<00:01, 65675.80it/s] 56%|█████▌    | 112013/200000 [00:01<00:01, 65732.08it/s] 59%|█████▉    | 118596/200000 [00:01<00:01, 65759.94it/s] 63%|██████▎   | 125173/200000 [00:01<00:01, 65537.43it/s] 66%|██████▌   | 131793/200000 [00:02<00:01, 65731.64it/s] 69%|██████▉   | 138367/200000 [00:02<00:00, 65558.39it/s] 72%|███████▏  | 144924/200000 [00:02<00:00, 65392.13it/s] 76%|███████▌  | 151514/200000 [00:02<00:00, 65542.24it/s] 79%|███████▉  | 158105/200000 [00:02<00:00, 65649.43it/s] 82%|████████▏ | 164671/200000 [00:02<00:00, 65561.68it/s] 86%|████████▌ | 171248/200000 [00:02<00:00, 65622.83it/s] 89%|████████▉ | 177832/200000 [00:02<00:00, 65686.11it/s] 92%|█████████▏| 184401/200000 [00:02<00:00, 65590.62it/s] 95%|█████████▌| 190961/200000 [00:02<00:00, 65365.58it/s] 99%|█████████▊| 197498/200000 [00:03<00:00, 65359.28it/s]100%|██████████| 200000/200000 [00:03<00:00, 65634.57it/s]
Getting token frequencies...
  0%|          | 0/25000 [00:00<?, ?it/s]  1%|          | 289/25000 [00:00<00:08, 2886.82it/s]  2%|▏         | 616/25000 [00:00<00:07, 3108.47it/s]  4%|▍         | 947/25000 [00:00<00:07, 3197.95it/s]  5%|▌         | 1286/25000 [00:00<00:07, 3270.53it/s]  7%|▋         | 1627/25000 [00:00<00:07, 3318.34it/s]  8%|▊         | 1972/25000 [00:00<00:06, 3362.86it/s]  9%|▉         | 2328/25000 [00:00<00:06, 3424.69it/s] 11%|█         | 2675/25000 [00:00<00:06, 3436.82it/s] 12%|█▏        | 3019/25000 [00:00<00:06, 3434.52it/s] 13%|█▎        | 3364/25000 [00:01<00:06, 3436.02it/s] 15%|█▍        | 3710/25000 [00:01<00:06, 3441.77it/s] 16%|█▌        | 4055/25000 [00:01<00:06, 3435.58it/s] 18%|█▊        | 4400/25000 [00:01<00:05, 3437.74it/s] 19%|█▉        | 4748/25000 [00:01<00:05, 3447.99it/s] 20%|██        | 5093/25000 [00:01<00:05, 3447.03it/s] 22%|██▏       | 5442/25000 [00:01<00:05, 3459.27it/s] 23%|██▎       | 5788/25000 [00:01<00:05, 3453.78it/s] 25%|██▍       | 6136/25000 [00:01<00:05, 3460.74it/s] 26%|██▌       | 6483/25000 [00:01<00:05, 3458.75it/s] 27%|██▋       | 6829/25000 [00:02<00:05, 3457.10it/s] 29%|██▊       | 7178/25000 [00:02<00:05, 3463.61it/s] 30%|███       | 7527/25000 [00:02<00:05, 3469.76it/s] 32%|███▏      | 7877/25000 [00:02<00:04, 3478.79it/s] 33%|███▎      | 8225/25000 [00:02<00:04, 3460.87it/s] 34%|███▍      | 8572/25000 [00:02<00:04, 3456.18it/s] 36%|███▌      | 8918/25000 [00:02<00:04, 3455.15it/s] 37%|███▋      | 9269/25000 [00:02<00:04, 3469.80it/s] 38%|███▊      | 9618/25000 [00:02<00:04, 3473.67it/s] 40%|███▉      | 9972/25000 [00:02<00:04, 3493.46it/s] 41%|████▏     | 10327/25000 [00:03<00:04, 3509.95it/s] 43%|████▎     | 10683/25000 [00:03<00:04, 3524.64it/s] 44%|████▍     | 11039/25000 [00:03<00:03, 3534.87it/s] 46%|████▌     | 11393/25000 [00:03<00:03, 3518.20it/s] 47%|████▋     | 11745/25000 [00:03<00:03, 3518.34it/s] 48%|████▊     | 12101/25000 [00:03<00:03, 3529.72it/s] 50%|████▉     | 12454/25000 [00:03<00:03, 3522.38it/s] 51%|█████     | 12808/25000 [00:03<00:03, 3525.98it/s] 53%|█████▎    | 13161/25000 [00:03<00:03, 3515.55it/s] 54%|█████▍    | 13517/25000 [00:03<00:03, 3525.42it/s] 55%|█████▌    | 13870/25000 [00:04<00:03, 3511.34it/s] 57%|█████▋    | 14222/25000 [00:04<00:03, 3511.71it/s] 58%|█████▊    | 14580/25000 [00:04<00:02, 3529.89it/s] 60%|█████▉    | 14934/25000 [00:04<00:02, 3527.33it/s] 61%|██████    | 15290/25000 [00:04<00:02, 3536.98it/s] 63%|██████▎   | 15648/25000 [00:04<00:02, 3548.35it/s] 64%|██████▍   | 16003/25000 [00:04<00:02, 3533.61it/s] 65%|██████▌   | 16357/25000 [00:04<00:02, 3529.36it/s] 67%|██████▋   | 16712/25000 [00:04<00:02, 3534.83it/s] 68%|██████▊   | 17066/25000 [00:04<00:02, 3526.30it/s] 70%|██████▉   | 17423/25000 [00:05<00:02, 3538.90it/s] 71%|███████   | 17784/25000 [00:05<00:02, 3559.90it/s] 73%|███████▎  | 18141/25000 [00:05<00:01, 3534.09it/s] 74%|███████▍  | 18495/25000 [00:05<00:01, 3518.44it/s] 75%|███████▌  | 18857/25000 [00:05<00:01, 3545.31it/s] 77%|███████▋  | 19212/25000 [00:05<00:01, 3529.89it/s] 78%|███████▊  | 19572/25000 [00:05<00:01, 3548.54it/s] 80%|███████▉  | 19929/25000 [00:05<00:01, 3553.58it/s] 81%|████████  | 20286/25000 [00:05<00:01, 3555.68it/s] 83%|████████▎ | 20642/25000 [00:05<00:01, 3549.93it/s] 84%|████████▍ | 20998/25000 [00:06<00:01, 3533.13it/s] 85%|████████▌ | 21352/25000 [00:06<00:01, 3529.46it/s] 87%|████████▋ | 21710/25000 [00:06<00:00, 3541.75it/s] 88%|████████▊ | 22067/25000 [00:06<00:00, 3547.41it/s] 90%|████████▉ | 22422/25000 [00:06<00:00, 3517.57it/s] 91%|█████████ | 22774/25000 [00:06<00:00, 3513.66it/s] 93%|█████████▎| 23132/25000 [00:06<00:00, 3532.25it/s] 94%|█████████▍| 23486/25000 [00:06<00:00, 3485.54it/s] 95%|█████████▌| 23844/25000 [00:06<00:00, 3511.52it/s] 97%|█████████▋| 24200/25000 [00:06<00:00, 3524.53it/s] 98%|█████████▊| 24553/25000 [00:07<00:00, 3518.81it/s]100%|█████████▉| 24905/25000 [00:07<00:00, 3507.89it/s]100%|██████████| 25000/25000 [00:07<00:00, 3488.41it/s]
  0%|          | 0/25000 [00:00<?, ?it/s]  1%|▏         | 349/25000 [00:00<00:07, 3484.21it/s]  3%|▎         | 713/25000 [00:00<00:06, 3572.62it/s]  4%|▍         | 1071/25000 [00:00<00:06, 3535.32it/s]  6%|▌         | 1425/25000 [00:00<00:06, 3522.70it/s]  7%|▋         | 1780/25000 [00:00<00:06, 3529.37it/s]  9%|▊         | 2135/25000 [00:00<00:06, 3534.45it/s] 10%|▉         | 2489/25000 [00:00<00:06, 3531.88it/s] 11%|█▏        | 2844/25000 [00:00<00:06, 3536.68it/s] 13%|█▎        | 3199/25000 [00:00<00:06, 3540.08it/s] 14%|█▍        | 3556/25000 [00:01<00:06, 3547.23it/s] 16%|█▌        | 3911/25000 [00:01<00:05, 3530.77it/s] 17%|█▋        | 4265/25000 [00:01<00:05, 3510.94it/s] 18%|█▊        | 4617/25000 [00:01<00:05, 3503.21it/s] 20%|█▉        | 4971/25000 [00:01<00:05, 3513.94it/s] 21%|██▏       | 5323/25000 [00:01<00:05, 3499.55it/s] 23%|██▎       | 5673/25000 [00:01<00:05, 3497.81it/s] 24%|██▍       | 6023/25000 [00:01<00:05, 3494.79it/s] 26%|██▌       | 6377/25000 [00:01<00:05, 3507.46it/s] 27%|██▋       | 6731/25000 [00:01<00:05, 3517.02it/s] 28%|██▊       | 7087/25000 [00:02<00:05, 3527.70it/s] 30%|██▉       | 7444/25000 [00:02<00:04, 3540.02it/s] 31%|███       | 7799/25000 [00:02<00:04, 3540.46it/s] 33%|███▎      | 8154/25000 [00:02<00:04, 3542.05it/s] 34%|███▍      | 8509/25000 [00:02<00:04, 3527.79it/s] 35%|███▌      | 8863/25000 [00:02<00:04, 3528.98it/s] 37%|███▋      | 9220/25000 [00:02<00:04, 3539.78it/s] 38%|███▊      | 9574/25000 [00:02<00:04, 3521.87it/s] 40%|███▉      | 9928/25000 [00:02<00:04, 3525.44it/s] 41%|████      | 10281/25000 [00:02<00:04, 3499.18it/s] 43%|████▎     | 10635/25000 [00:03<00:04, 3510.06it/s] 44%|████▍     | 10990/25000 [00:03<00:03, 3520.45it/s] 45%|████▌     | 11343/25000 [00:03<00:03, 3516.21it/s] 47%|████▋     | 11698/25000 [00:03<00:03, 3525.13it/s] 48%|████▊     | 12053/25000 [00:03<00:03, 3530.50it/s] 50%|████▉     | 12412/25000 [00:03<00:03, 3547.00it/s] 51%|█████     | 12767/25000 [00:03<00:03, 3534.45it/s] 52%|█████▏    | 13121/25000 [00:03<00:03, 3522.44it/s] 54%|█████▍    | 13474/25000 [00:03<00:03, 3509.22it/s] 55%|█████▌    | 13826/25000 [00:03<00:03, 3509.98it/s] 57%|█████▋    | 14178/25000 [00:04<00:03, 3506.11it/s] 58%|█████▊    | 14532/25000 [00:04<00:02, 3513.37it/s] 60%|█████▉    | 14891/25000 [00:04<00:02, 3534.28it/s] 61%|██████    | 15245/25000 [00:04<00:02, 3521.88it/s] 62%|██████▏   | 15599/25000 [00:04<00:02, 3525.85it/s] 64%|██████▍   | 15952/25000 [00:04<00:02, 3520.11it/s] 65%|██████▌   | 16305/25000 [00:04<00:02, 3517.40it/s] 67%|██████▋   | 16657/25000 [00:04<00:02, 3509.17it/s] 68%|██████▊   | 17010/25000 [00:04<00:02, 3512.62it/s] 69%|██████▉   | 17362/25000 [00:04<00:02, 3505.11it/s] 71%|███████   | 17713/25000 [00:05<00:02, 3495.58it/s] 72%|███████▏  | 18065/25000 [00:05<00:01, 3501.57it/s] 74%|███████▎  | 18417/25000 [00:05<00:01, 3505.34it/s] 75%|███████▌  | 18776/25000 [00:05<00:01, 3528.40it/s] 77%|███████▋  | 19129/25000 [00:05<00:01, 3522.60it/s] 78%|███████▊  | 19482/25000 [00:05<00:01, 3517.84it/s] 79%|███████▉  | 19839/25000 [00:05<00:01, 3532.45it/s] 81%|████████  | 20196/25000 [00:05<00:01, 3541.66it/s] 82%|████████▏ | 20551/25000 [00:05<00:01, 3539.65it/s] 84%|████████▎ | 20905/25000 [00:05<00:01, 3531.19it/s] 85%|████████▌ | 21259/25000 [00:06<00:01, 3518.73it/s] 86%|████████▋ | 21611/25000 [00:06<00:00, 3508.06it/s] 88%|████████▊ | 21967/25000 [00:06<00:00, 3521.70it/s] 89%|████████▉ | 22320/25000 [00:06<00:00, 3511.19it/s] 91%|█████████ | 22672/25000 [00:06<00:00, 3497.42it/s] 92%|█████████▏| 23028/25000 [00:06<00:00, 3515.43it/s] 94%|█████████▎| 23381/25000 [00:06<00:00, 3518.84it/s] 95%|█████████▍| 23733/25000 [00:06<00:00, 3511.62it/s] 96%|█████████▋| 24085/25000 [00:06<00:00, 3501.60it/s] 98%|█████████▊| 24436/25000 [00:06<00:00, 3488.74it/s] 99%|█████████▉| 24789/25000 [00:07<00:00, 3500.53it/s]100%|██████████| 25000/25000 [00:07<00:00, 3519.37it/s]
  Strongly routed (mw < 0.5): 1 tokens
    ' tree'              mw=0.000
  Moderately routed (0.5 <= mw < 0.85): 3 tokens
    ' bird'              mw=0.586
    ' flew'              mw=0.810
    ' bear'              mw=0.816

Full results saved to /home/a6a/lucia.a6a/gradient-routing/projects/tinystories/../../eval_output/eval_comparison.json

======================================================================
SUMMARY TABLE
======================================================================
Model                           Forget↑  Retain↓  TgtWds↓   Repet↓ ActRatio
---------------------------------------------------------------------------
Pretrained baseline               1.201    1.273       12    0.034      N/A
From-scratch (full_seq)           3.323    2.088        1    0.046    2.16x
Post-training (full_seq)          1.337    1.122        6    0.027    1.37x

Forget↑ = higher forget loss is better (model forgot more)
Retain↓ = lower retain loss is better (model preserved knowledge)
TgtWds↓ = fewer target words in generation is better (suppression)
Repet↓  = lower repetition is better (coherence)
ActRatio = expanded dim forget/retain activation ratio (selectivity)

Done!
Done: Thu 19 Feb 2026 08:05:54 UTC
